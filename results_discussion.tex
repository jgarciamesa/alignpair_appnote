\section*{Results and Discussion}
Using 16000 human genes and their gorilla orthologs from the ENSEMBL
database \citembe{ensembl_hubbard_2002}, we simulated a data set of pairwise
alignments with empirical gap patterns.
We used the data set to evaluate the accuracy of COATi and a suite of popular aligners spanning multiple alignment methods:
Clustal$\Omega$ v1.2.4 \citembe{clustal_omega_sievers_2011},
MACSE v2.06 \citembe{ranwez_macse_2011}, MAFFT v7.505
\citembe{katoh2013mafft}, and PRANK v.150803 \citembe{prank_loytynoja_2014}.

After downloading, we removed 2232 sequences longer than 6000 nucleotides, identified 6048 sequence pairs that contained gaps identified by at least one aligner, and 7719 ungapped sequence pairs.
We then randomly introduced gap patterns extracted from all five methods into the ungapped sequence pairs to generate the benchmark alignments.
Alignment accuracy was measured using the distance metric, $d_{seq}$
\citembe{metrics_blackburne_whelan_2011}, between simulated and inferred
alignments.
In addition, accuracy of positive and negative selection was calculated
using the $F_1$ score by estimating $k_s$ and $k_a$ statistics
\citembe{ka_ks_li_1993} (Supplementary Methods).
The $F_1$ score evaluates the accuracy of a model by assigning equal importance to precision and recall, and ranges between 0 and 1, with a score of 0 representing a perfect result.

% Software comparison table
\begin{table}[!ht]
\centering
\input{figures/table-comp}
 \vspace{1mm}
 \footnotesize{* PRANK produced 50 empty alignments, calculations are based on 7869 alignments.}
 \caption{COATi generates better alignments than other alignment algorithms. Results of COATi, PRANK, MAFFT, Clustal$\Omega$, and MACSE aligning 7719 empirically simulated sequence pairs. Perfect alignments have the same score as the true alignment, best alignments have the lowest $d_{seq}$, and imperfect alignments have a different score than the true alignment when at least one method found a perfect alignment.}
 \label{table:comp}
\end{table}

COATi, using the codon-triplet-mg model, obtained better results compared to a wide variety of alignment strategies.
It was significantly more accurate (lower $d_{seq}$) at inferring simulated alignments compared to other methods; all p-values were less than $2.1 \cdot 10^{-79}$ according to the one-tailed, paired Wilcoxon signed-rank tests (Supplementary Materials Figure 1).
%
In addition, COATi produced more perfect alignments, less imperfect alignments, and more accurately retrieved events of positive selection (Table \ref{table:comp}).

Clustal$\Omega$ generated alignments via amino acid translations and obtained the highest average alignment error while having difficulties retrieving positive selection.
MACSE used a DNA-AA hybrid model, allowing frameshifts, and obtained similar results to MAFFT using a DNA model.
PRANK, using a codon model, had a similar average alignment error between MACSE/MAFFT and Clustal$\Omega$ but was unable to generate alignments for some sequence pairs.

Despite human and gorilla sequences having a relatively short evolutionary distance, COATi showed a biologically significant improvement over other methods, with an average alignment error nine-fold smaller than the next best method.
COATi is an FST-based application that can calculate the optimal alignment
between a pair of sequences in the presence of artifacts using a statistical
model.
Using COATI will allow researchers to analyze more data with higher accuracy and facilitate the study of important biological processes that shape genomic data.

Future work include extending the indel FST to combine a 3-mer gap model with a frameshift parameter and weighing each indel phase differently to reflect known selection on indel phases \citembe{zhu2022profiling}.
We also plan on comparing the marginal and triplet models to evaluate the implications of the marginalization.
